{{define "healthz"}}
<!DOCTYPE html>
<html lang="en" class="theme-{{.Theme}}">
<head>
    {{template "public/head" .}}
</head>
<body>
    <a href="#main-content" class="skip-link">Skip to main content</a>
    {{template "public/header" .}}
    {{template "public/nav" .}}
    <main id="main-content" role="main" class="content-area health-status">
        <!-- Project Info per AI.md PART 13 -->
        <header class="health-header">
            <h1>ğŸ“¦ {{.ProjectName}}</h1>
            <p class="project-description">{{.ProjectDescription}}</p>
        </header>

        <h2>ğŸ¥ System Health</h2>

        <!-- Status Banner per AI.md PART 13 -->
        <div class="status-banner status-{{.StatusClass}}">
            <span class="status-icon">{{.StatusIcon}}</span>
            <span class="status-text">{{.StatusText}}</span>
        </div>

        <!-- Version & Build Info per AI.md PART 13 -->
        <section class="health-section">
            <h2>â„¹ï¸ Version</h2>
            <dl class="info-grid">
                <dt>ğŸ·ï¸ Version</dt><dd><code>{{.Version}}</code></dd>
                <dt>ğŸ¹ Go Version</dt><dd><code>{{.GoVersion}}</code></dd>
                <dt>ğŸ”¨ Build</dt><dd><code>{{.BuildCommit}}</code> ({{.BuildDate}})</dd>
                <dt>â±ï¸ Uptime</dt><dd>{{.Uptime}}</dd>
                <dt>ğŸš€ Mode</dt><dd><span class="badge badge-{{.Mode}}">{{.ModeDisplay}}</span></dd>
            </dl>
        </section>

        {{if .ClusterEnabled}}
        <!-- Cluster Info per AI.md PART 13 -->
        <section class="health-section">
            <h2>ğŸ”— Cluster</h2>
            <dl class="info-grid">
                <dt>Status</dt><dd><span class="status-{{.ClusterStatusClass}}">{{.ClusterStatusIcon}} {{.ClusterStatus}}</span></dd>
                <dt>ğŸ‘‘ Primary</dt><dd><code>{{.ClusterPrimary}}</code></dd>
                <dt>ğŸ­ Role</dt><dd>{{.ClusterRole}}</dd>
            </dl>
            {{if .ClusterNodes}}
            <h3>ğŸ–¥ï¸ Nodes</h3>
            <ul class="node-list">
                {{range .ClusterNodes}}
                <li><code>{{.URL}}</code>{{if .IsPrimary}} <span class="badge badge-primary">ğŸ‘‘ Primary</span>{{end}}</li>
                {{end}}
            </ul>
            {{end}}
        </section>
        {{end}}

        <!-- Features per AI.md PART 13 (VidVeil: stateless per IDEA.md) -->
        <section class="health-section">
            <h2>ğŸ›ï¸ Features</h2>
            <ul class="feature-list">
                <li class="{{if .Features.TorEnabled}}feature-enabled{{else}}feature-disabled{{end}}">
                    ğŸ§… Tor: {{if .Features.TorEnabled}}<span class="status-ok">âœ… {{.Features.TorStatus}}</span> <code>{{.Features.TorOnionAddr}}</code>{{else}}<span class="status-disabled">Disabled</span>{{end}}
                </li>
                <li class="{{if .Features.GeoIP}}feature-enabled{{else}}feature-disabled{{end}}">
                    ğŸŒ GeoIP: {{if .Features.GeoIP}}<span class="status-ok">âœ… Enabled</span>{{else}}<span class="status-disabled">Disabled</span>{{end}}
                </li>
                <li class="{{if .Features.Metrics}}feature-enabled{{else}}feature-disabled{{end}}">
                    ğŸ“Š Metrics: {{if .Features.Metrics}}<span class="status-ok">âœ… Enabled</span>{{else}}<span class="status-disabled">Disabled</span>{{end}}
                </li>
            </ul>
        </section>

        <!-- Component Checks per AI.md PART 13 -->
        <section class="health-section">
            <h2>ğŸ”§ Component Status</h2>
            <table class="checks-table">
                <thead><tr><th>Component</th><th>Status</th></tr></thead>
                <tbody>
                    <tr>
                        <td>ğŸ—„ï¸ Database</td>
                        <td class="status-{{if eq .Checks.Database "ok"}}ok{{else}}error{{end}}">{{if eq .Checks.Database "ok"}}âœ… OK{{else}}âŒ Error{{end}}</td>
                    </tr>
                    <tr>
                        <td>ğŸ’¾ Cache</td>
                        <td class="status-{{if eq .Checks.Cache "ok"}}ok{{else}}error{{end}}">{{if eq .Checks.Cache "ok"}}âœ… OK{{else}}âŒ Error{{end}}</td>
                    </tr>
                    <tr>
                        <td>ğŸ’¿ Disk</td>
                        <td class="status-{{if eq .Checks.Disk "ok"}}ok{{else}}error{{end}}">{{if eq .Checks.Disk "ok"}}âœ… OK{{else}}âŒ Error{{end}}</td>
                    </tr>
                    <tr>
                        <td>â° Scheduler</td>
                        <td class="status-{{if eq .Checks.Scheduler "ok"}}ok{{else}}error{{end}}">{{if eq .Checks.Scheduler "ok"}}âœ… OK{{else}}âŒ Error{{end}}</td>
                    </tr>
                    {{if .ClusterEnabled}}
                    <tr>
                        <td>ğŸ”— Cluster</td>
                        <td class="status-{{if eq .Checks.Cluster "ok"}}ok{{else}}error{{end}}">{{if eq .Checks.Cluster "ok"}}âœ… OK{{else}}âŒ Error{{end}}</td>
                    </tr>
                    {{end}}
                </tbody>
            </table>
        </section>

        <!-- Statistics per AI.md PART 13 -->
        <section class="health-section">
            <h2>ğŸ“ˆ Statistics</h2>
            <dl class="info-grid stats-grid">
                <dt>ğŸ“¥ Total Requests</dt><dd>{{.Stats.RequestsTotal}}</dd>
                <dt>ğŸ“… Requests (24h)</dt><dd>{{.Stats.Requests24h}}</dd>
                <dt>ğŸ”Œ Active Connections</dt><dd>{{.Stats.ActiveConnections}}</dd>
            </dl>
        </section>

        <!-- Last Updated per AI.md PART 13 -->
        <footer class="health-footer">
            <p>Last checked: <time datetime="{{.Timestamp}}">{{.TimestampDisplay}}</time></p>
            <p class="auto-refresh">Auto-refreshing in <span id="countdown">30</span>s</p>
        </footer>
    </main>
    {{template "public/footer" .}}
    {{template "public/scripts" .}}
    <script>
        // Auto-refresh countdown per AI.md PART 13
        (function() {
            let seconds = 30;
            const countdown = document.getElementById('countdown');
            setInterval(function() {
                seconds--;
                if (countdown) countdown.textContent = seconds;
                if (seconds <= 0) {
                    location.reload();
                }
            }, 1000);
        })();
    </script>
</body>
</html>
{{end}}
